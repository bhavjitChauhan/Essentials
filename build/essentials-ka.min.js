// {
/**
 * Essentials.
 *
 * The Essentials library provides utility functions for the Khan Academy
 * Processing Environment.
 *
 * @link https://github.com/bhavjitChauhan/Essentials
 * @file Minified KA Essentials Build
 * @author Bhavjit Chauhan
 */

// jshint ignore: start
(/\/*/);
function _createForOfIteratorHelper(o,allowArrayLike){var it=typeof Symbol!=="undefined"&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function(){};return{s:F,n:function(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function(e){throw e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function(){it=it.call(o)},n:function(){var step=it.next();normalCompletion=step.done;return step},e:function(e){didErr=true;err=e},f:function(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!=="undefined"&&arr[Symbol.iterator]||arr["@@iterator"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}_environment_=this instanceof Window?"CDN":"KA";_console_style_="font-family:system-ui;font-size:0.75rem;";_core_initialized_=typeof ESSENTIALS_CORE!=="undefined";ESSENTIALS_CORE=true;ESSENTIALS_VERSION="2.0.0";ESSENTIALS_ASCII="\n    _/_/_/_/    _/_/_/    _/_/_/  _/_/_/_/  _/      _/  _/_/_/_/_/  _/_/_/    _/_/    _/          _/_/_/\n   _/        _/        _/        _/        _/_/    _/      _/        _/    _/    _/  _/        _/\n  _/_/_/      _/_/      _/_/    _/_/_/    _/  _/  _/      _/        _/    _/_/_/_/  _/          _/_/\n _/              _/        _/  _/        _/    _/_/      _/        _/    _/    _/  _/              _/\n_/_/_/_/  _/_/_/    _/_/_/    _/_/_/_/  _/      _/      _/      _/_/_/  _/    _/  _/_/_/_/  _/_/_/\n\n";_silent_=typeof _silent_!=="undefined"&&_silent_;if(!_silent_&&!_core_initialized_)console.info("%cESSENTIALS\n%cThe Khan Academy utility library.\n\n".concat(_environment_," Build\nVersion ").concat(ESSENTIALS_VERSION,"\nCopyright \xA9 2021 Bhavjit Chauhan\nhttps://github.com/bhavjitChauhan/Essentials"),"color:transparent;\nfont-size:3rem;\nbackground-image: url('https://github.com/bhavjitChauhan/Essentials/blob/master/logo.png?raw=true');\nbackground-position:center;\nbackground-repeat: no-repeat;\nbackground-size:contain;",_console_style_);_eval=eval;p=Processing.instances[0];var _ref=[p.LEFT,p.RIGHT,p.TOP,p.BOTTOM,p.UP,p.DOWN];LEFT=_ref[0];RIGHT=_ref[1];TOP=_ref[2];BOTTOM=_ref[3];UP=_ref[4];DOWN=_ref[5];TOP_LEFT=1,TOP_RIGHT=2,BOTTOM_RIGHT=3,BOTTOM_LEFT=4;WIDTH=p.width;HEIGHT=p.height;HALF_WIDTH=WIDTH/2;HALF_HEIGHT=HEIGHT/2;ctx=p.externals.context;WHITE=4294967295;SILVER=4290822336;GREY=4286611584;BLACK=4278190080;RED=4294901760;MAROON=4286578688;ORANGE=4294944000;YELLOW=4294967040;OLIVE=4286611456;LIME=4278255360;GREEN=4278222848;AQUA=4278255615;TEAL=4278222976;BLUE=4278190335;NAVY=4278190208;FUCHSIA=4294902015;PURPLE=4286578816;TRANSPARENT=16777215;_hash=function(buffer){var seed=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var PRIME_1=2654435761,PRIME_2=2246822519,PRIME_3=3266489917,PRIME_4=668265263,PRIME_5=374761393;var b=buffer;var acc=seed+PRIME_5&4294967295;var offset=0;if(b.length>=16){var accN=[seed+PRIME_1+PRIME_2&4294967295,seed+PRIME_2&4294967295,seed+0&4294967295,seed-PRIME_1&4294967295];var _b=buffer;var _limit=_b.length-16;var lane=0;for(offset=0;(offset&4294967280)<=_limit;offset+=4){var i=offset;var laneN0=_b[i+0]+(_b[i+1]<<8);var laneN1=_b[i+2]+(_b[i+3]<<8);var laneNP=laneN0*PRIME_2+(laneN1*PRIME_2<<16);var _acc=accN[lane]+laneNP&4294967295;_acc=_acc<<13|_acc>>>19;var acc0=_acc&65535;var acc1=_acc>>>16;accN[lane]=acc0*PRIME_1+(acc1*PRIME_1<<16)&4294967295;lane=lane+1&3}acc=(accN[0]<<1|accN[0]>>>31)+(accN[1]<<7|accN[1]>>>25)+(accN[2]<<12|accN[2]>>>20)+(accN[3]<<18|accN[3]>>>14)&4294967295}acc=acc+buffer.length&4294967295;var limit=buffer.length-4;for(;offset<=limit;offset+=4){var _i=offset;var _laneN=b[_i+0]+(b[_i+1]<<8);var _laneN2=b[_i+2]+(b[_i+3]<<8);var laneP=_laneN*PRIME_3+(_laneN2*PRIME_3<<16);acc=acc+laneP&4294967295;acc=acc<<17|acc>>>15;acc=(acc&65535)*PRIME_4+((acc>>>16)*PRIME_4<<16)&4294967295}for(;offset<b.length;++offset){var _lane=b[offset];acc=acc+_lane*PRIME_5;acc=acc<<11|acc>>>21;acc=(acc&65535)*PRIME_1+((acc>>>16)*PRIME_1<<16)&4294967295}acc=acc^acc>>>15;acc=((acc&65535)*PRIME_2&4294967295)+((acc>>>16)*PRIME_2<<16);acc=acc^acc>>>13;acc=((acc&65535)*PRIME_3&4294967295)+((acc>>>16)*PRIME_3<<16);return(acc<0?acc+4294967296:acc).toString(16)};_pointOnRect=function(width,height,angle){angle=-angle;while(angle<-Math.PI){angle+=p.TAU}while(angle>Math.PI){angle-=p.TAU}var rectAtan=Math.atan2(height,width);var tanTheta=Math.tan(angle);var region;if(angle>-rectAtan&&angle<=rectAtan){region=1}else if(angle>rectAtan&&angle<=Math.PI-rectAtan){region=2}else if(angle>Math.PI-rectAtan||angle<=-(Math.PI-rectAtan)){region=3}else{region=4}var result={x:width/2,y:height/2};var dx=1;var dy=1;switch(region){case 1:dy=-1;break;case 2:dy=-1;break;case 3:dx=-1;break;case 4:dx=-1;break;}if(region==1||region==3){result.x+=dx*(width/2);result.y+=dy*(width/2)*tanTheta}else{result.x+=dx*(height/(2*tanTheta));result.y+=dy*(height/2)}return result};clearLogs=function(){return p._clearLogs()};noop=function(){};showGraphics=function(){return drawGraphics()};attempt=function(fn){try{for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key]}return fn.apply(void 0,args)}catch(err){return err instanceof Error?err:new Error(err)}};chainAsync=function(fns){var i=0;var last=_.last(fns);var next=function(){var fn=fns[i++];fn===last?fn():fn(next)};next()};clean=function(fn){var string=fn.toString().replace(/__env__\.KAInfiniteLoopCount\+\+;/g,"").replace(/if \(__env__\.KAInfiniteLoopCount > 1000\) {[\s]+__env__\.KAInfiniteLoopProtect\('[^']*'\);[^}]+}/g,"").replace(/__env__\.PJSOutput\.applyInstance\((__env__\.\S+), '\S+'\)/g,"new $1");return Object.constructor("return (function(__env__) {return ".concat(string,";});"))()(p)};complement=function(fn){return function(){return!fn.apply(void 0,arguments)}};evalPJS=function(str){return _eval("with (p) ".concat(str))};drawGraphics=function(x,y,width,height,fn){var renderer=arguments.length>5&&arguments[5]!==undefined?arguments[5]:p.P2D;var g=p.createGraphics(width,height,renderer);fn.call(g);p.image(g,x,y)};generateID=function(){var length=arguments.length>0&&arguments[0]!==undefined?arguments[0]:8;var odd=length%2!=0;var arr=_eval("new Uint8Array(Math.ceil(".concat(length," / 2))"));crypto.getRandomValues(arr);var id=Array.from(arr,function(i){return i.toString(16).padStart(2,"0")}).join("");return odd?id.slice(0,-1):id};generateUUID=function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(c){return(c^crypto.getRandomValues(_eval("new Uint8Array(1)"))[0]&15>>c/4).toString(16)})};getColonTime=function(){return new Date().toTimeString().slice(0,8)};inherit=function(subClass,superClass){Object.setPrototypeOf(subClass.prototype,superClass.prototype);subClass.prototype.constructor=subClass;if(superClass.prototype.constructor===Object)superClass.prototype.constructor=superClass};isEmptyFunction=function(fn){return _.isFunction(fn)&&/^function[^{]*[{]\s*[}]\s*$/.test(Function.prototype.toString.call(fn))};isFont=function(obj){return obj instanceof p.PFont};isImage=function(obj){return obj instanceof p.PImage};isSound=function(obj){return obj.audio instanceof Audio};mostPerformant=function(fns){var iterations=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1e4;var timings=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var times=fns.map(function(fn){var startTime=performance.now();for(var i=0;i<iterations;i++){fn()}return performance.now()-startTime});if(timings)return times;return times.indexOf(Math.min.apply(Math,_toConsumableArray(times)))};pop=function(){p.popStyle();ctx.restore()};printf=function(str){str=str.toString();for(var _len2=arguments.length,args=new Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++){args[_key2-1]=arguments[_key2]}for(var _i2=0,_args=args;_i2<_args.length;_i2++){var arg=_args[_i2];str=str.replace(/(?<!\\)%/,arg)}str=str.replaceAll(/\\%/g,"%");p.println(str)};randomInt=function(min,max){return _.random(min,max)};push=function(){p.pushStyle();ctx.save()};restart=function(){if(typeof COLOR_ESSENTIALS!="undefined"){noShadow();shadowBlur(0);shadowOffset(0,0)}if(typeof SHAPE_ESSENTIALS!="undefined"){noStrokeDash();strokeDashOffset(0)}if(typeof EXTERNAL_ESSENTIALS!="undefined"){clearElements();closeLog();exitPointerLock();forceAllowScroll()}p.colorMode(p.RGB,255);p.draw=noop;p.Program.restart()};roundTo=function(n,precision){if(!precision)return n;return Math.round(n/precision)*precision};timeTaken=function(callback){var id=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"default";console.time("timeTaken#".concat(id));var r=callback();console.timeEnd("timeTaken#".concat(id));return r};_color_initialized_=typeof COLOR_ESSENTIALS!=="undefined";if(typeof ESSENTIALS_CORE==="undefined"){console.error("Color Essentials depends on the Essentials Core.")}else{COLOR_ESSENTIALS=true;if(!_silent_&&!_color_initialized_)console.info("%cColor Essentials",_console_style_)}BRIGHTNESS="brightness";LUMINANCE="brightness";CONTRAST="contrast";DROP_SHADOW="drop-shadow";GRAYSCALE=p.GRAY;HUE_ROTATE="hue-rotate";OPACITY="opacity";SATURATE="saturate";SEPIA="sepia";RGB_COLOR_RANGE=[255,255,255,255];HSB_COLOR_RANGE=[360,100,100,100];MEDIUM_VIOLET_RED=4291237253;DEEP_PINK=4294907027;PALE_VIOLET_RED=4292571283;HOT_PINK=4294928820;LIGHT_PINK=4294948545;PINK=4294951115;DARK_RED=4287299584;RED=4294901760;FIRE_BRICK=4289864226;CRIMSON=4292613180;INDIAN_RED=4291648604;LIGHT_CORAL=4293951616;SALMON=4294606962;DARK_SALMON=4293498490;LIGHT_SALMON=4294942842;ORANGE_RED=4294919424;TOMATO=4294927175;DARK_ORANGE=4294937600;CORAL=4294934352;ORANGE=4294944000;DARK_KHAKI=4290623339;GOLD=4294956800;KHAKI=4293977740;PEACH_PUFF=4294957753;YELLOW=4294967040;PALE_GOLDENROD=4293847210;MOCCASIN=4294960309;PAPAYA_WHIP=4294963157;LIGHT_GOLDENROD_YELLOW=4294638290;LEMON_CHIFFON=4294965965;LIGHT_YELLOW=4294967264;MAROON=4286578688;BROWN=4289014314;SADDLE_BROWN=4287317267;SIENNA=4288696877;CHOCOLATE=4291979550;DARK_GOLDENROD=4290283019;PERU=4291659071;ROSY_BROWN=4290547599;GOLDENROD=4292519200;SANDY_BROWN=4294222944;TAN=4291998860;BURLY_WOOD=4292786311;WHEAT=4294303411;NAVAJO_WHITE=4294958765;BISQUE=4294960324;BLANCHED_ALMOND=4294962125;CORNSILK=4294965468;DARK_GREEN=4278215680;GREEN=4278222848;DARK_OLIVE_GREEN=4283788079;FOREST_GREEN=4280453922;SEA_GREEN=4281240407;OLIVE=4286611456;OLIVE_DRAB=4285238819;MEDIUM_SEA_GREEN=4282168177;LIME_GREEN=4281519410;LIME=4278255360;SPRING_GREEN=4278255487;MEDIUM_SPRING_GREEN=4278254234;DARK_SEA_GREEN=4287609999;MEDIUM_AQUAMARINE=4284927402;YELLOW_GREEN=4288335154;LAWN_GREEN=4286381056;CHARTREUSE=4286578432;LIGHT_GREEN=4287688336;GREEN_YELLOW=4289593135;PALE_GREEN=4288215960;TEAL=4278222976;DARK_CYAN=4278225803;LIGHT_SEA_GREEN=4280332970;CADET_BLUE=4284456608;DARK_TURQUOISE=4278243025;MEDIUM_TURQUOISE=4282962380;TURQUOISE=4282441936;AQUA=4278255615;CYAN=4278255615;AQUAMARINE=4286578644;PALE_TURQUOISE=4289720046;LIGHT_CYAN=4292935679;NAVY=4278190208;DARK_BLUE=4278190219;MEDIUM_BLUE=4278190285;BLUE=4278190335;MIDNIGHT_BLUE=4279834992;ROYAL_BLUE=4282477025;STEEL_BLUE=4282811060;DODGER_BLUE=4280193279;DEEP_SKY_BLUE=4278239231;CORNFLOWER_BLUE=4284782061;SKY_BLUE=4287090411;LIGHT_SKY_BLUE=4287090426;LIGHT_STEEL_BLUE=4289774814;LIGHT_BLUE=4289583334;POWDER_BLUE=4289781990;INDIGO=4283105410;PURPLE=4286578816;DARK_MAGENTA=4287299723;DARK_VIOLET=4287889619;DARK_SLATE_BLUE=4282924427;BLUE_VIOLET=4287245282;DARK_ORCHID=4288230092;FUCHSIA=4294902015;MAGENTA=4294902015;SLATE_BLUE=4285160141;MEDIUM_SLATE_BLUE=4286277870;MEDIUM_ORCHID=4290401747;MEDIUM_PURPLE=4287852763;ORCHID=4292505814;VIOLET=4293821166;PLUM=4292714717;THISTLE=4292394968;LAVENDER=4293322490;REBECCA_PURPLE=4284887961;MISTY_ROSE=4294960353;ANTIQUE_WHITE=4294634455;LINEN=4294635750;BEIGE=4294309340;WHITE_SMOKE=4294309365;LAVENDER_BLUSH=4294963445;OLD_LACE=4294833638;ALICE_BLUE=4293982463;SEASHELL=4294964718;GHOST_WHITE=4294506751;HONEYDEW=4293984240;FLORAL_WHITE=4294966000;AZURE=4293984255;MINT_CREAM=4294311930;SNOW=4294966010;IVORY=4294967280;WHITE=4294967295;BLACK=4278190080;DARK_SLATE_GRAY=DARK_SLATE_GREY=4281290575;DIM_GRAY=DIM_GREY=4285098345;SLATE_GRAY=SLATE_GREY=4285563024;GREY=4286611584;LIGHT_SLATE_GRAY=LIGHT_SLATE_GREY=4286023833;DARK_GRAY=DARK_GREY=4289309097;SILVER=4290822336;LIGHT_GRAY=LIGHT_GREY=4292072403;GAINSBORO=4292664540;_createColor=function(arr){var colorMode=arguments.length>1&&arguments[1]!==undefined?arguments[1]:getColorMode();var currentColorMode=arguments.length>2&&arguments[2]!==undefined?arguments[2]:colorMode;var oppositeColorMode=colorMode==p.RGB?p.HSB:p.RGB;var isDifferentColorMode=currentColorMode==oppositeColorMode;var defaultAlpha=getAlphaRange();if(currentColorMode!=colorMode){if(colorMode==p.RGB)defaultAlpha=RGB_COLOR_RANGE[3];else defaultAlpha=HSB_COLOR_RANGE[3]}arr=_parseColorArray(arr,defaultAlpha);if(isDifferentColorMode){p.pushStyle();presetColorMode(colorMode)}result=p.color.apply(null,arr);isDifferentColorMode&&p.popStyle();return result};_appendFilter=function(filter){if(ctx.filter=="none")return ctx.filter=filter;ctx.filter+=filter};_parseColorArray=function(arr){var defaultAlpha=arguments.length>1&&arguments[1]!==undefined?arguments[1]:getAlphaRange();var range=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(_.isNumber(arr))arr=[arr];switch(arr.length){case 1:arr=[arr[0],arr[0],arr[0],range?arr[0]:defaultAlpha];break;case 2:arr=[arr[0],arr[0],arr[0],arr[1]];break;case 3:arr.push(defaultAlpha);}return arr};clearEffects=function(){return ctx.filter="none"};getAlphaRange=function(){return p.alpha(WHITE)};getBlueRange=function(){return p.blue(WHITE)};getBrightnessRange=function(){return getBlueRange()};getGreenRange=function(){return p.green(WHITE)};getHueRange=function(){return getRedRange()};getRedRange=function(){return p.red(WHITE)};getSaturationRange=function(){return getGreenRange()};getShadow=function(){return hexToRGB(ctx.shadowColor)};getShadowBlur=function(){return ctx.shadowBlur};isDefaultColorRange=function(){return getColorRange()==RGB_COLOR_RANGE};noShadow=function(){return shadow(TRANSPARENT)};getShadowOffset=function(){return[ctx.shadowOffsetX,ctx.shadowOffsetY]};angularGradient=function(x,y,width,height,startColor,endColor){var angle=arguments.length>6&&arguments[6]!==undefined?arguments[6]:0;var step=arguments.length>7&&arguments[7]!==undefined?arguments[7]:5;angle-=90;var dTheta=Math.ceil(p.degrees(Math.atan(step/Math.max(width,height)))*10)/10;p.pushStyle();if(step==1){p.strokeWeight(1.5);for(var i=angle;i<angle+359;i+=dTheta){p.stroke(p.lerpColor(startColor,endColor,(i-angle)/360));r=p.radians(i);p.line(x+width/2,y+height/2,p.map(Math.cos(r),-1,1,x,x+width),p.map(Math.sin(r),-1,1,y,y+height))}}else{p.strokeWeight(1);for(var _i3=angle;_i3<angle+359;_i3+=dTheta){var c=p.lerpColor(startColor,endColor,(_i3-angle)/360);p.stroke(c);p.fill(c);r1=p.radians(_i3);r2=p.radians(_i3-dTheta);p.triangle(x+width/2,y+height/2,p.map(Math.cos(r1),-1,1,x,x+width),p.map(Math.sin(r1),-1,1,y,y+height),p.map(Math.cos(r2),-1,1,x,x+width),p.map(Math.sin(r2),-1,1,y,y+height))}}p.popStyle()};circularGradient=function(x,y,width,height,startColor,endColor){var angle=arguments.length>6&&arguments[6]!==undefined?arguments[6]:0;var step=arguments.length>7&&arguments[7]!==undefined?arguments[7]:5;var dTheta=Math.ceil(p.degrees(Math.atan(step/Math.max(width,height)))*10)/10;p.pushStyle();if(step==1){p.strokeWeight(1.5);for(var i=angle-1;i<angle+180;i+=dTheta){p.stroke(p.lerpColor(startColor,endColor,Math.abs((i-angle)/180)));r=p.radians(i);p.line(x+width/2,y+height/2,p.map(Math.cos(r),-1,1,x,x+width),p.map(Math.sin(r),-1,1,y,y+height))}for(var _i4=angle-1;_i4>angle-180;_i4-=dTheta){p.stroke(p.lerpColor(startColor,endColor,Math.abs((_i4-angle)/180)));r=p.radians(_i4);p.line(x+width/2,y+height/2,p.map(Math.cos(r),-1,1,x,x+width),p.map(Math.sin(r),-1,1,y,y+height))}}else{p.strokeWeight(1);for(var _i5=angle-1;_i5<angle+180;_i5+=dTheta){var c=p.lerpColor(startColor,endColor,Math.abs((_i5-angle)/180));p.stroke(c);p.fill(c);r1=p.radians(_i5);r2=p.radians(_i5-dTheta);p.triangle(x+width/2,y+height/2,p.map(Math.cos(r1),-1,1,x,x+width),p.map(Math.sin(r1),-1,1,y,y+height),p.map(Math.cos(r2),-1,1,x,x+width),p.map(Math.sin(r2),-1,1,y,y+height))}r1=p.radians(angle-180);r2=p.radians(angle-180-dTheta);p.stroke(endColor);p.fill(endColor);p.triangle(x+width/2,y+height/2,p.map(Math.cos(r1),-1,1,x,x+width),p.map(Math.sin(r1),-1,1,y,y+height),p.map(Math.cos(r2),-1,1,x,x+width),p.map(Math.sin(r2),-1,1,y,y+height));for(var _i6=angle-1;_i6>angle-180;_i6-=dTheta){var _c=p.lerpColor(startColor,endColor,Math.abs((_i6-angle)/180));p.stroke(_c);p.fill(_c);r1=p.radians(_i6);r2=p.radians(_i6-dTheta);p.triangle(x+width/2,y+height/2,p.map(Math.cos(r1),-1,1,x,x+width),p.map(Math.sin(r1),-1,1,y,y+height),p.map(Math.cos(r2),-1,1,x,x+width),p.map(Math.sin(r2),-1,1,y,y+height))}}p.popStyle()};p.blur=function(){var radius=arguments.length>0&&arguments[0]!==undefined?arguments[0]:5;if(_.isNumber(radius))radius="".concat(radius,"px");_appendFilter("blur(".concat(radius,")"))};contrast=function(amount){return _appendFilter("contrast(".concat(amount,"%)"))};dropShadow=function(x){var y=arguments.length>1&&arguments[1]!==undefined?arguments[1]:x;var radius=arguments.length>2&&arguments[2]!==undefined?arguments[2]:5;var color=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"#000";if(_.isNumber(color))color=RGBToHex(color);_appendFilter("drop-shadow(".concat(x,"px ").concat(y,"px ").concat(radius,"px ").concat(color,")"))};effect=function(filter){var _p;for(var _len3=arguments.length,args=new Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++){args[_key3-1]=arguments[_key3]}switch(filter){case p.BLUR:return(_p=p).blur.apply(_p,args);case BRIGHTNESS:case LUMINANCE:return luminance.apply(void 0,args);case CONTRAST:return contrast.apply(void 0,args);case DROP_SHADOW:return dropShadow.apply(void 0,args);case p.GRAY:case GRAYSCALE:return grayscale.apply(void 0,args);case HUE_ROTATE:return hueRotate.apply(void 0,args);case p.INVERT:return invert.apply(void 0,args);case OPACITY:return opacity.apply(void 0,args);case SATURATE:return saturate.apply(void 0,args);case SEPIA:return sepia.apply(void 0,args);}_appendFilter(filter)};fastBlur=function(){var strength=arguments.length>0&&arguments[0]!==undefined?arguments[0]:10;var x=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var y=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var width=arguments.length>3&&arguments[3]!==undefined?arguments[3]:WIDTH;var height=arguments.length>4&&arguments[4]!==undefined?arguments[4]:width||HEIGHT;if(x<0){width+=x;x=0}if(y<0){height+=y;y=0}strength=p.constrain(strength,0,Math.min(width,height));p.image(p.get(x,y,width,height),x,y,width/strength,height/strength);p.image(p.get(x,y,width/strength,height/strength),x,y,width,height)};getColorMode=function(){return p.color(getRedRange(),0,0)==-65536?p.RGB:p.HSB};getColorRange=function(){return[p.red,p.green,p.blue,p.alpha].map(function(fn){return fn.call(null,WHITE)})};getFill=function(){var draw=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;draw&&p.rect(0,0,"%");return hexToRGB(ctx.fillStyle)};getStroke=function(){var draw=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;draw&&p.rect(0,0,"%");return hexToRGB(ctx.strokeStyle)};grayscale=function(){var amount=arguments.length>0&&arguments[0]!==undefined?arguments[0]:100;return _appendFilter("grayscale(".concat(amount,"%)"))};hexToHSB=function(hex){var color=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(color)return hexToRGB(hex);return RGBToHSB.apply(p,hexToRGB(hex,false))};hexToRGB=function(hex){var color=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var currentColorMode=getColorMode();hex=hex.replace("#","");switch(hex.length){case 3:case 6:hex=hex.replace(/^([a-f\d])([a-f\d])([a-f\d])$/i,function(_m,r,g,b){return r+r+g+g+b+b});break;case 4:case 8:hex=hex.replace(/^([a-f\d])([a-f\d])([a-f\d])([a-f\d])$/i,function(_m,r,g,b,a){return r+r+g+g+b+b+a+a});break;}var arr=hex.match(/.{2}/g).map(function(x){return parseInt(x,16)});if(arr.length==3)arr.push(RGB_COLOR_RANGE[3]);if(!isDefaultColorRange()&&currentColorMode==p.RGB){arr=mapColorRange(arr)}var result=arr;if(color)result=_createColor(arr,p.RGB,currentColorMode);return result};HSBToHex=function(){var shorthand=true,octothorpe=true;for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++){args[_key4]=arguments[_key4]}if(_.every(_.last(args,2),_.isBoolean)){octothorpe=args.pop();shorthand=args.pop()}else if(_.isBoolean(_.last(args)))shorthand=args.pop();var notDefaultColorRange=!isDefaultColorRange();notDefaultColorRange&&p.pushStyle();presetColorMode(p.RGB);var arr=HSBToRGB.apply(void 0,args).map(function(value){return Math.round(value)});notDefaultColorRange&&p.popStyle();return RGBToHex.apply(void 0,_toConsumableArray(arr).concat([shorthand,octothorpe]))};HSBToRGB=function(){var currentColorRange=getColorRange();var mapColorRange=getColorMode()==p.RGB?currentColorRange:RGB_COLOR_RANGE;var h,s,b,a;for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++){args[_key5]=arguments[_key5]}switch(args.length){case 1:{var notDefaultColorRange=!isDefaultColorRange();if(notDefaultColorRange){p.pushStyle();presetColorMode(p.HSB)}var _toHSB=toHSB(args[0]);var _toHSB2=_slicedToArray(_toHSB,4);h=_toHSB2[0];s=_toHSB2[1];b=_toHSB2[2];a=_toHSB2[3];notDefaultColorRange&&p.popStyle();h/=60,s/=100,b/=100,a/=100;break}case 3:case 4:if(args.length==4)a=args.pop()/HSB_COLOR_RANGE[3];h=args.shift()/60;var _args$map=args.map(function(value,i){return value/=HSB_COLOR_RANGE[i+1]});var _args$map2=_slicedToArray(_args$map,2);s=_args$map2[0];b=_args$map2[1];}f=function(n){var k=arguments.length>1&&arguments[1]!==undefined?arguments[1]:(n+h)%6;return b-b*s*Math.max(Math.min(k,4-k,1),0)};var arr=[f(5),f(3),f(1),a||1];arr=arr.map(function(value,i){return value*mapColorRange[i]});return arr};hueRotate=function(angle){return _appendFilter("hue-rotate(".concat(angle).concat(p.angleMode=="degrees"?"deg":"rad",")"))};invert=function(){var amount=arguments.length>0&&arguments[0]!==undefined?arguments[0]:100;return _appendFilter("invert(".concat(amount,"%)"))};linearGradient=function(settings){var x=settings.x,y=settings.y,width=settings.width,height=settings.height,stops=settings.stops,angle=settings.angle,x0=settings.x0,y0=settings.y0,x1=settings.x1,y1=settings.y1;height=height||width;if(_.isNumber(angle)){if(p.angleMode=="degrees")angle=p.radians(angle);var _result=_pointOnRect(width,height,angle);x0=x0||x+width-_result.x;y0=y0||y+height-_result.y;x1=x1||x+_result.x;y1=y1||y+_result.y}push();var gradient=ctx.createLinearGradient(x0,y0,x1,y1);if(!_.every(stops,_.isArray))stops=stops.map(function(color,i,arr){return[p.norm(i,0,arr.length-1),color]});var _iterator=_createForOfIteratorHelper(stops),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var stop=_step.value;if(_.isNumber(stop[1]))stop[1]=RGBToHex(stop[1],false);gradient.addColorStop.apply(gradient,_toConsumableArray(stop))}}catch(err){_iterator.e(err)}finally{_iterator.f()}ctx.fillStyle=gradient;ctx.fillRect(x,y,width,height);pop()};luminance=function(amount){return _appendFilter("brightness(".concat(amount,"%)"))};opacity=function(amount){return _appendFilter("opacity(".concat(amount,"%)"))};presetColorMode=function(mode){if(!mode)mode=getColorMode()==p.RGB?p.HSB:p.RGB;switch(mode){case p.RGB:p.colorMode(p.RGB,255);break;case p.HSB:p.colorMode(p.HSB,360,100,100,100);}};mapColorRange=function(values,colorRange){var currentColorRange=getColorRange();if(colorRange){colorRange=_parseColorArray(colorRange,currentColorRange[3],true);values=_parseColorArray(values,currentColorRange[3]).map(function(value,i){return p.map(value,0,currentColorRange[i],0,colorRange[i])})}else{values=_parseColorArray(values,255).map(function(value,i){return p.map(value,0,255,0,currentColorRange[i])})}return values};radialGradient=function(settings){var x=settings.x,y=settings.y,width=settings.width,height=settings.height,stops=settings.stops,x0=settings.x0,y0=settings.y0,r0=settings.r0,x1=settings.x1,y1=settings.y1,r1=settings.r1;height=height||width;var centerX=x+width/2;var centerY=y+height/2;if(!_.isNumber(x0))x0=centerX;if(!_.isNumber(y0))y0=centerY;r0=r0||0;if(!_.isNumber(x1))x1=centerX;if(!_.isNumber(y1))y1=centerY;r1=r1||width/2;push();var gradient=ctx.createRadialGradient(x0,y0,r0,x1,y1,r1);if(!_.every(stops,_.isArray))stops=stops.map(function(color,i,arr){return[p.norm(i,0,arr.length-1),color]});var _iterator2=_createForOfIteratorHelper(stops),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var stop=_step2.value;if(_.isNumber(stop[1]))stop[1]=RGBToHex(stop[1],false);gradient.addColorStop.apply(gradient,_toConsumableArray(stop))}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}ctx.fillStyle=gradient;ctx.fillRect(x,y,width,height);pop()};RGBToHex=function(){var hexadecimal,shorthand=true,octothorpe=true;for(var _len6=arguments.length,args=new Array(_len6),_key6=0;_key6<_len6;_key6++){args[_key6]=arguments[_key6]}if(_.every(_.last(args,2),_.isBoolean)){octothorpe=args.pop();shorthand=args.pop()}else if(_.isBoolean(_.last(args)))shorthand=args.pop();switch(args.length){case 1:{var a=p.alpha(args[0]);hexadecimal=p.hex(args[0],6)+(a!=RGB_COLOR_RANGE[3]?a.toString(16).padStart(2,"0"):"");break}case 3:case 4:hexadecimal=((1<<24)+(args[0]<<16)+(args[1]<<8)+args[2]).toString(16).slice(1);if(args.length==4&&args[3]!=RGB_COLOR_RANGE[3])hexadecimal+=args[3].toString(16).padStart(2,"0");}if(shorthand){if(hexadecimal.length==8)hexadecimal=hexadecimal.replace(/(\w)\1(\w)\2(\w)\3(\w)\4/,"$1$2$3$4");if(hexadecimal.length==6)hexadecimal=hexadecimal.replace(/(\w)\1(\w)\2(\w)\3/,"$1$2$3")}return(octothorpe?"#":"")+hexadecimal.toUpperCase()};RGBToHSB=function(){var currentColorRange=getColorRange();var mapColorRange=getColorMode()==p.HSB?currentColorRange:HSB_COLOR_RANGE;var fns=[function(hue){return p.map(hue,0,6,0,mapColorRange[0])},function(saturation){return saturation*mapColorRange[1]},function(brightness){return brightness*mapColorRange[2]},function(alpha){return alpha*mapColorRange[3]}];var r,g,b,a;for(var _len7=arguments.length,args=new Array(_len7),_key7=0;_key7<_len7;_key7++){args[_key7]=arguments[_key7]}switch(args.length){case 1:{var notDefaultColorRange=!isDefaultColorRange();if(notDefaultColorRange){p.pushStyle();presetColorMode(p.RGB)}var _toRGB$map=toRGB(args[0]).map(function(value,i){return value/=RGB_COLOR_RANGE[i]});var _toRGB$map2=_slicedToArray(_toRGB$map,4);r=_toRGB$map2[0];g=_toRGB$map2[1];b=_toRGB$map2[2];a=_toRGB$map2[3];notDefaultColorRange&&p.popStyle();break}case 3:case 4:if(args.length==4)a=args.pop()/RGB_COLOR_RANGE[3];var _args$map3=args.map(function(value,i){return value/=RGB_COLOR_RANGE[i]});var _args$map4=_slicedToArray(_args$map3,3);r=_args$map4[0];g=_args$map4[1];b=_args$map4[2];}var max=Math.max(r,g,b),chroma=max-Math.min(r,g,b);var hue=chroma&&(max==r?(g-b)/chroma:max==g?2+(b-r)/chroma:4+(r-g)/chroma);var arr=[hue<0?hue+6:hue,max&&chroma/max,max,a||1];arr=arr.map(function(value,i){return fns[i](value)});return arr};saturate=function(amount){return _appendFilter("saturate(".concat(amount,"%)"))};sepia=function(){var amount=arguments.length>0&&arguments[0]!==undefined?arguments[0]:100;return _appendFilter("sepia(".concat(amount,"%)"))};shadow=function(){for(var _len8=arguments.length,args=new Array(_len8),_key8=0;_key8<_len8;_key8++){args[_key8]=arguments[_key8]}var color=args[0];if(args.length>1)color=p.color.apply(null,args);if(_.isNumber(args[0]))color=RGBToHex(color,false);ctx.shadowColor=color};shadowBlur=function(radius){return ctx.shadowBlur=radius};shadowOffset=function(x){var y=arguments.length>1&&arguments[1]!==undefined?arguments[1]:x;if(_.isNumber(x))ctx.shadowOffsetX=x;ctx.shadowOffsetY=y};toHSB=function(){for(var _len9=arguments.length,args=new Array(_len9),_key9=0;_key9<_len9;_key9++){args[_key9]=arguments[_key9]}switch(args.length){case 1:{var col=args[0];if(_.isNumber(col)){var isRGB=getColorMode()==p.RGB;if(isRGB){p.pushStyle();presetColorMode(p.HSB)}var arr=[p.hue(col),p.saturation(col),p.brightness(col),p.alpha(col)];isRGB&&p.popStyle();return arr}return hexToHSB(col)}case 3:case 4:return RGBToHSB.apply(p,args);}};toRGB=function(){for(var _len10=arguments.length,args=new Array(_len10),_key10=0;_key10<_len10;_key10++){args[_key10]=arguments[_key10]}switch(args.length){case 1:{var col=args[0];if(_.isNumber(col)){var isHSB=getColorMode()==p.HSB;if(isHSB){p.pushStyle();presetColorMode(p.RGB)}var arr=[p.red(col),p.green(col),p.blue(col),p.alpha(col)];isHSB&&p.popStyle();return arr}return hexToRGB(col)}case 3:case 4:return HSBToRGB.apply(p,args);}};linearGradientOld=function(x,y,width,height,startColor,endColor){var direction=arguments.length>6&&arguments[6]!==undefined?arguments[6]:RIGHT;var step=arguments.length>7&&arguments[7]!==undefined?arguments[7]:5;push();e.strokeWeight(1);switch(direction){case LEFT:case RIGHT:if(direction==LEFT){var _ref2=[endColor,startColor];startColor=_ref2[0];endColor=_ref2[1]}if(step==1){for(var i=0;i<width;i++){e.stroke(e.lerpColor(startColor,endColor,i/width));e.line(x+i,y,x+i,y+height)}}else{for(var _i7=0;_i7<width;_i7+=step){var c=e.lerpColor(startColor,endColor,_i7/width);e.stroke(c);e.fill(c);if(_i7+step>width){e.rect(x+_i7,y,width-_i7,height)}else{e.rect(x+_i7,y,step,height)}}}break;case TOP:case UP:case BOTTOM:case DOWN:if(direction==TOP||direction==UP){var _ref3=[endColor,startColor];startColor=_ref3[0];endColor=_ref3[1]}if(step==1){for(var _i8=0;_i8<height;_i8++){e.stroke(e.lerpColor(startColor,endColor,_i8/height));e.line(x,y+_i8,x+width,y+_i8)}}else{for(var _i9=0;_i9<height;_i9+=step){var _c2=e.lerpColor(startColor,endColor,_i9/height);e.stroke(_c2);e.fill(_c2);if(_i9+step>width){e.rect(x,y+_i9,width,height-_i9)}else{e.rect(x,y+_i9,width,step)}}}break;case TOP_LEFT:case BOTTOM_RIGHT:if(direction==TOP_LEFT){var _ref4=[endColor,startColor];startColor=_ref4[0];endColor=_ref4[1]}if(step==1){for(var _i10=0;_i10<width;_i10++){e.stroke(e.lerpColor(startColor,endColor,_i10/width/2));e.line(x+_i10,y,x,y+e.map(_i10,0,width,0,height))}for(var _i11=0;_i11<width;_i11++){e.stroke(e.lerpColor(startColor,endColor,_i11/width/2+0.5));e.line(x+_i11,y+height,x+width,y+e.map(_i11,0,width,0,height))}}else{var side=Math.max(width,height)*Math.sqrt(2);showGraphics(x,y,width,height,function(){this.angleMode="degrees";this.rotate(-45);for(var _i12=0;_i12<side;_i12+=step){var _c3=this.lerpColor(startColor,endColor,_i12/side);this.stroke(_c3);this.fill(_c3);if(_i12+step>side){this.rect(-side/2,_i12,side,side-_i12)}else{this.rect(-side/2,_i12,side,step)}}})}break;case TOP_RIGHT:case BOTTOM_LEFT:if(direction==TOP_RIGHT){var _ref5=[endColor,startColor];startColor=_ref5[0];endColor=_ref5[1]}if(step==1){for(var _i13=0;_i13<width;_i13++){e.stroke(e.lerpColor(startColor,endColor,_i13/width/2));e.line(x+width-_i13,y,x+width,y+e.map(_i13,0,width,0,height))}for(var _i14=0;_i14<width;_i14++){e.stroke(e.lerpColor(startColor,endColor,_i14/width/2+0.5));e.line(x+width-_i14,y+height,x,y+e.map(_i14,0,width,0,height))}}else{var _side=Math.max(width,height)*Math.sqrt(2);showGraphics(x,y,width,height,function(){this.angleMode="degrees";this.rotate(45);for(var _i15=0;_i15<_side;_i15+=step){var _c4=this.lerpColor(startColor,endColor,_i15/_side);this.stroke(_c4);this.fill(_c4);if(_i15+step>_side){this.rect(0,_i15-_side/2,_side,_side-_i15)}else{this.rect(0,_i15-_side/2,_side,step)}}})}}pop()};radialGradientOld=function(x,y,width,height,startColor,endColor){var step=arguments.length>6&&arguments[6]!==undefined?arguments[6]:5;push();e.strokeWeight(1);var maxRadius=Math.max(width,height);if(step==1){e.noFill();for(var i=0;i<maxRadius;i++){e.stroke(e.lerpColor(endColor,startColor,i/maxRadius));e.arc(x,y,width-e.map(i,0,maxRadius,0,width),height-e.map(i,0,maxRadius,0,height),0,360)}}else{for(var _i16=0;_i16<maxRadius;_i16+=step){var c=e.lerpColor(endColor,startColor,_i16/maxRadius);e.stroke(c);e.fill(c);e.ellipse(x,y,width-e.map(_i16,0,maxRadius,0,width),height-e.map(_i16,0,maxRadius,0,height))}}pop()};_text_initialized_=typeof TEXT_ESSENTIALS!=="undefined";if(typeof ESSENTIALS_CORE==="undefined"){console.error("Text Essentials depends on the Essentials Core.")}else{TEXT_ESSENTIALS=true;if(!_silent_&&!_text_initialized_)console.info("%cText Essentials",_console_style_)}f=function(str){return format(str)};getTextSize=function(){return ctx.font.match(/\d+/)};fastGradientText=function(string,x,y,startColor,endColor){p.pushStyle();if(!string.includes("\n")){for(var i=0;i<string.length;i++){p.fill(p.lerpColor(startColor,endColor,i/string.length));p.text(string[i],x+p.textWidth(string.slice(0,i)),y)}}else{var _strings=string.split("\n");for(var _i17 in _strings){fastGradientText(_strings[_i17],x,y+_i17*textAscent(),startColor,endColor)}}p.popStyle()};font=function(family){var properties=Array.from(arguments).slice(1);properties.push("");var call=properties.find(function(property){return _.isBoolean(property)});call=!_.isBoolean(call)&&true;properties=_.without(properties,true,false);var _font;var size=properties.find(function(property){return!isNaN(property)});if(isFont(family)){_font=family;size=size||+_font.css.match(/\d+/)[0];previousCSS=_font.css.split(" ");previousProperties=previousCSS.slice(0,-2).filter(function(property){return property!=="normal"});properties=_.union(properties,previousProperties);var negates=properties.filter(function(property){if(!_.isString(property))return false;return property.charAt(0)=="-"});negates=negates.map(function(negate){return negate.substr(1)});properties=properties.filter(function(property){if(!_.isString(property))return false;return property.charAt(0)!="-"});properties=_.difference(properties,negates).join(" ");_font.css="".concat(properties," ").concat(size,"px/").concat(size+2,"px ").concat(_.last(previousCSS))}else{size=size||12;_font=p.createFont(family,size);properties=_.without(properties,size);_font.css=(!_.isEmpty(properties)&&properties.join(" ")+" ")+"".concat(size,"px/").concat(size+2,"px ").concat(family)}call&&p.textFont(_font);return _font};format=function(str){return evalPJS("`".concat(str,"`"))};formatDuration=function(ms,precision){var raw=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(!ms)return"0";if(ms<0)ms=-ms;if(precision)ms=roundTo(ms,precision);if(ms<1e-3)return"0";var time={year:Math.floor(ms/3.1536e10),month:Math.floor(ms/2.592e9),day:Math.floor(ms/8.64e7),hour:Math.floor(ms/3.6e6)%24,minute:Math.floor(ms/6e4)%60,second:Math.floor(ms/1e3)%60,millisecond:Math.floor(ms)%1e3,microsecond:Math.floor(ms*1e3)%1e3};if(raw)return Object.values(time);return Object.entries(time).filter(function(val){return val[1]!==0}).map(function(_ref6){var _ref7=_slicedToArray(_ref6,2),key=_ref7[0],val=_ref7[1];return"".concat(val," ").concat(pluralize(val,key))}).join(", ")};formatNumber=function(n){var locales=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"en";var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return n.toLocaleString(locales,options)};highlightText=function(string,x,y){var highlightColor=arguments.length>3&&arguments[3]!==undefined?arguments[3]:YELLOW;if(!/\S/.test(string)){return}string=string.split("\n");p.pushStyle();p.noStroke();p.rectMode(p.CORNER);p.textAlign(p.LEFT,p.TOP);for(var i in string){string[i]=" ".concat(string[i]," ");p.pushStyle();p.fill(highlightColor);p.rect(x,y+i*p.textAscent()*2,p.textWidth(string[i]),p.textAscent()*1.75);p.popStyle();p.text(string[i],x,y+i*p.textAscent()*2)}p.popStyle()};lightOrDarkText=function(backgroundColor){var r,g,b;if(typeof backgroundColor==="string"){var _result2=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(backgroundColor);r=parseInt(_result2[1],16);g=parseInt(_result2[2],16);b=parseInt(_result2[3],16)}else{r=p.red(backgroundColor);g=p.green(backgroundColor);b=p.blue(backgroundColor)}if((r+b+g)/3<225){return WHITE}return BLACK};multicoloredText=function(string,x,y){if(!/\S/.test(string)){return}string=string.split("\n");p.pushStyle();p.textAlign(p.LEFT,p.CORNER);for(var i in string){string[i]=string[i].split(/\[|]/);var splits=0;for(var j in string[i]){if(/\d+,\d+,\d+/.test(string[i][j])){var rgb=string[i][j].split(",");p.fill.apply(p,rgb);delete string[i][j];if(splits===0){string[i][j-1]+=" "}splits+=1}else{var w=p.textWidth(string[i].slice(0,j));p.text(string[i][j],x+w-splits*2*p.textWidth(" "),y+i*p.textAscent()*2)}}}p.popStyle()};obfuscate=function(str){var result="";for(var i in _.range(str.length)){var curr=str.charCodeAt(i).toString(16);if(curr.length<=2){while(curr.length<2){curr="0"+curr}result+="\\x"+curr}else{while(curr.length<4){curr="0"+curr}result+="\\u"+curr}}return result};ordinalSuffix=function(n){var int=parseInt(n,10),digits=[int%10,int%100],oPattern=[1,2,3,4],ordinals=["st","nd","rd","th"],tPattern=[11,12,13,14,15,16,17,18,19];return oPattern.includes(digits[0])&&!tPattern.includes(digits[1])?int+ordinals[digits[0]-1]:int+ordinals[3]};outlineText=function(str,x,y){var weight=arguments.length>3&&arguments[3]!==undefined?arguments[3]:5;var color=arguments.length>4&&arguments[4]!==undefined?arguments[4]:BLACK;str=str.replace("\n","");ctx.save();ctx.lineJoin="round";ctx.lineWidth=weight;if(_.isNumber(color))color=typeof COLOR_ESSENTIALS!="undefined"?RGBToHex(color,false):"#"+hex(color,6);ctx.strokeStyle=color;ctx.strokeText(str,x,y);ctx.restore();p.pushStyle();p.textAlign(p.LEFT,p.TOP);p.text(str,x,y);p.popStyle()};pluralize=function(value,word){var plural=arguments.length>2&&arguments[2]!==undefined?arguments[2]:word+"s";var _pluralize=function(num,word){var plural=arguments.length>2&&arguments[2]!==undefined?arguments[2]:word+"s";return[1,-1].includes(Number(num))?word:plural};if(typeof value==="object")return function(num,word){return _pluralize(num,word,value[word])};return _pluralize(value,word,plural)};removeNonASCII=function(str){return str.replace(/[^\x20-\x7E]/g,"")};String.prototype.format=function(){return format(this)};String.prototype.obfuscate=function(){return obfuscate(this)};String.prototype.removeNonASCII=function(){return removeNonASCII(this)};String.prototype.toTitleCase=function(){return toTitleCase(this)};String.prototype.toCamelCase=function(){return toCamelCase(this)};String.prototype.toKebabCase=function(){return toKebabCase(this)};String.prototype.toSnakeCase=function(){return toSnakeCase(this)};toCamelCase=function(str){var s=str.match(/[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g).map(function(x){return x.slice(0,1).toUpperCase()+x.slice(1).toLowerCase()}).join("");return s.slice(0,1).toLowerCase()+s.slice(1)};toKebabCase=function(str){return str.match(/[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g).map(function(x){return x.toLowerCase()}).join("-")};toSnakeCase=function(str){return str.match(/[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g).map(function(x){return x.toLowerCase()}).join("_")};toTitleCase=function(str){return str.match(/[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g).map(function(x){return x.charAt(0).toUpperCase()+x.slice(1)}).join(" ")};underlineText=function(string,x,y){var underlineColor=arguments.length>3&&arguments[3]!==undefined?arguments[3]:BLACK;var underlineWeight=arguments.length>4&&arguments[4]!==undefined?arguments[4]:p.externals.context.font.match(/\d+/)[0]/12;if(!/\S/.test(string)){return}strings=string.split("\n");p.pushStyle();p.strokeCap(p.SQUARE);p.strokeWeight(underlineWeight);p.stroke(underlineColor);for(var i in strings){p.line(x,y+p.textAscent()/4+p.textAscent()*i*1.55,x+p.textWidth(strings[i]),y+p.textAscent()/4+p.textAscent()*i*1.55)}p.textAlign(p.LEFT,p.CORNER);p.text(string,x,y);p.popStyle()};wordWrap=function(str,max){var br=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"\n";return str.replace(new RegExp("(?![^\\n]{1,".concat(max,"}$)([^\\n]{1,").concat(max,"})\\s"),"g"),"$1"+br)};outlineTextOld=function(string){var x=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var y=arguments.length>2&&arguments[2]!==undefined?arguments[2]:e.textAscent();var outlineColor=arguments.length>3&&arguments[3]!==undefined?arguments[3]:BLACK;if(!/\S/.test(string)){return}push();e.fill(outlineColor);for(var i=-2;i<3;i++){for(var j=-1;j<3;j++){e.text(string,x+i,y+j)}e.text(string,x+i,y);e.text(string,x,y+i)}pop();e.text(string,x,y)};_shape_initialized_=typeof SHAPE_ESSENTIALS!=="undefined";if(typeof ESSENTIALS_CORE==="undefined"){console.error("Shape Essentials depends on the Essentials Core.")}else{SHAPE_ESSENTIALS=true;if(!_silent_&&!_shape_initialized_)console.info("%cShape Essentials",_console_style_)}getStrokeCap=function(){return ctx.lineCap};getStrokeJoin=function(){return ctx.lineJoin};getStrokeWeight=function(){return ctx.lineWidth};noStrokeDash=function(){return strokeDash()};circle=function(x,y,radius){return p.ellipse(x,y,radius,radius)};cylinder=function(x,y,width,height){width=Math.abs(width);height=Math.abs(height);p.pushMatrix();p.translate(x,y);if(height>width){var _TAU=Math.cos(Math.PI)<0?p.TWO_PI:360;p.rotate(_TAU/4);cylinder(0,0,height,width)}else{var _r=height/2;var z=(width-height)/2;var central=4/3*(Math.sqrt(2)-1)*_r;drawShape(function(){p.vertex(z,-_r);p.bezierVertex(z+central,-_r,z+_r,-central,z+_r,0);p.bezierVertex(z+_r,central,z+central,_r,z,_r);p.vertex(-z,_r);p.bezierVertex(-z-central,_r,-z-_r,central,-z-_r,0);p.bezierVertex(-z-_r,-central,-z-central,-_r,-z,-_r)},true)}p.popMatrix()};donut=function(x,y,majorDiameter,minorDiameter){var kappa=4/3*(Math.sqrt(2)-1);p.pushMatrix();p.translate(x,y);p.pushStyle();p.noStroke();drawShape(function(){var radius=minorDiameter/2;var central=kappa*radius;p.vertex(radius,0);p.bezierVertex(radius,central,central,radius,0,radius);p.bezierVertex(-central,radius,-radius,central,-radius,0);p.bezierVertex(-radius,-central,-central,-radius,0,-radius);p.bezierVertex(central,-radius,radius,-central,radius,0);radius=majorDiameter/2;central=kappa*radius;p.vertex(radius,0);p.bezierVertex(radius,-central,central,-radius,0,-radius);p.bezierVertex(-central,-radius,-radius,-central,-radius,0);p.bezierVertex(-radius,central,-central,radius,0,radius);p.bezierVertex(central,radius,radius,central,radius,0)},true);p.popStyle();p.pushStyle();p.noFill();circle(0,0,minorDiameter);circle(0,0,majorDiameter);p.popStyle();p.popMatrix()};drawShape=function(fn,close,mode){close=close&&p.CLOSE;p.beginShape(mode);fn();p.endShape(close)};edge=function(x,y,length){var angle=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;if(p.angleMode=="degrees")angle=p.radians(angle);var x2=x+length*Math.cos(angle);var y2=y+length*Math.sin(angle);p.line(x,y,x2,y2)};getRotation=function(){var degrees=arguments.length>0&&arguments[0]!==undefined?arguments[0]:p.angleMode=="degrees";var matrix=arguments.length>1&&arguments[1]!==undefined?arguments[1]:ctx.getTransform();var angle=Math.atan2(matrix.b,matrix.a);if(angle<0)angle+=Math.PI*2;return degrees?p.degrees(angle):angle};heart=function(x,y,radius){var ay=y-2*radius/5,by=y+radius,c1y=y-6*radius/5,c2y=y-2*radius/5;var c1x=x+radius/2,c2x=x+9*radius/5;drawShape(function(){p.vertex(x,ay);p.bezierVertex(c1x,c1y,c2x,c2y,x,by);c1x=2*x-c1x;c2x=2*x-c2x;p.bezierVertex(c2x,c2y,c1x,c1y,x,ay)},true)};parallelogram=function(ax,ay,bx,by,cx,cy){var dx=bx-ax;var dy=by-ay;p.quad(ax,ay,bx,by,cx+dx,cy+dy,cx,cy)};polygon=function(x,y,sides,radius,rotation){var _TAU=Math.cos(Math.PI)<0?2*Math.PI:360;p.pushMatrix();p.translate(x,y);p.rotate(rotation==undefined?-_TAU/4:rotation);drawShape(function(){for(var theta=0;theta<_TAU;theta+=_TAU/sides){p.vertex(radius*Math.cos(theta),radius*Math.sin(theta))}},true);p.popMatrix()};rectangle=function(x,y,width){var height=arguments.length>3&&arguments[3]!==undefined?arguments[3]:width;var tl=arguments.length>4?arguments[4]:undefined;var tr=arguments.length>5?arguments[5]:undefined;var br=arguments.length>6?arguments[6]:undefined;var bl=arguments.length>7?arguments[7]:undefined;if(tl==undefined)p.rect(x,y,width,height);else if(tr==undefined)p.rect(x,y,width,height,tl);else if(br==undefined)p.rect(x,y,width,height,tl,tl,tr,tr);else if(bl==undefined)p.rect(x,y,width,height,tl,tr,br,0);else p.rect(x,y,width,height,tl,tr,br,bl)};rhombus=function(ax,ay,bx,by,cx,cy){var r=p.dist(ax,ay,bx,by)/p.dist(ax,ay,cx,cy);cx=ax+r*(cx-ax);cy=ay+r*(cy-ay);parallelogram(ax,ay,bx,by,cx,cy)};square=function(x,y,side,tl,tr,br,bl){if(tl==undefined)p.rect(x,y,side,side);else if(tr==undefined)p.rect(x,y,side,side,tl);else if(br==undefined)p.rect(x,y,side,side,tl,tl,tr,tr);else if(bl==undefined)p.rect(x,y,side,side,tl,tr,br,0);else p.rect(x,y,side,side,tl,tr,br,bl)};star=function(x,y,externalRadius){var spikes=arguments.length>3&&arguments[3]!==undefined?arguments[3]:5;var rotation=arguments.length>4?arguments[4]:undefined;var _TAU=Math.cos(Math.PI)<0?p.TWO_PI:360;var interior=externalRadius*Math.sin(1/20*_TAU)/Math.sin(7/20*_TAU);p.pushMatrix();p.translate(x,y);p.rotate(rotation==undefined?-_TAU/4:rotation);drawShape(function(){var internalRadius;for(var theta=0;theta<_TAU;theta+=_TAU/(2*spikes)){internalRadius=internalRadius===externalRadius?interior:externalRadius;p.vertex(internalRadius*Math.cos(theta),internalRadius*Math.sin(theta))}},true);p.popMatrix()};strokeDash=function(){for(var _len11=arguments.length,segments=new Array(_len11),_key11=0;_key11<_len11;_key11++){segments[_key11]=arguments[_key11]}return ctx.setLineDash(segments)};strokeDashOffset=function(offset){return ctx.lineDashOffset=offset};trapezoid=function(x,y,height,topBase,bottomBase){var maxBase=Math.max(topBase,bottomBase);p.quad(x+(maxBase-topBase)/2,y,x+(maxBase-topBase)/2+topBase-1,y,x+(maxBase-bottomBase)/2+bottomBase-1,y+height-1,x+(maxBase-bottomBase)/2,y+height-1)};
// }
