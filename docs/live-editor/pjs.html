<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Live Editor</title>
    <link rel="stylesheet" href="./build/css/live-editor.core_deps.css" />
    <link rel="stylesheet" href="./build/css/live-editor.audio.css" />
    <link rel="stylesheet" href="./build/css/live-editor.tooltips.css" />
    <link rel="stylesheet" href="./build/css/live-editor.ui.css" />
    <style>
        body {
            padding: 20px;
        }

        h1 {
            padding: 0;
            margin: 0 0 20px 0;
        }

        #live-editor {
            padding: 0;
        }
    </style>
</head>

<body>
    <div id="live-editor"></div>

    <script src="./build/js/live-editor.core_deps.js"></script>
    <script src="./build/js/live-editor.editor_ace_deps.js"></script>
    <script src="./build/js/live-editor.audio.js"></script>
    <script src="./build/js/live-editor.shared.js"></script>
    <script src="./build/js/live-editor.tooltips.js"></script>
    <script src="./build/js/live-editor.ui.js"></script>
    <script src="./build/js/live-editor.editor_ace.js"></script>

    <script>
        const code = window.localStorage['test-pjs-code']
            || `// jshint ignore: start
(/\\/*/);

function init() {
    printMD(f('Essentials v$\{ESSENTIALS_VERSION}'));
}

function main() {
    
}

$.ajaxSetup({ cache: true });
$.getScript('https://cdn.jsdelivr.net/gh/bhavjitChauhan/Essentials@2/build/essentials-x.min.js',
    function() {
        init();
        draw = main;
    }
);
`;

        const paramsString = window.location.search;
        const searchParams = new URLSearchParams(paramsString);
        const width = searchParams.get('width');
        const height = searchParams.get('height');

        window.liveEditor = new LiveEditor({
            el: $('#live-editor'),
            code: code,
            width: width || 400,
            height: height || 400,
            editorHeight: '100%',
            autoFocus: true,
            workersDir: './build/workers/',
            externalsDir: './build/external/',
            imagesDir: './assets/images/',
            soundsDir: './assets/sounds/',
            execFile: 'output-pjs.html',
            jshintFile: './build/external/jshint/jshint.js',
            newErrorExperience: true
        });
        liveEditor.editor.on('change', function () {
            window.localStorage['test-pjs-code'] = liveEditor.editor.text();
        });
        ScratchpadAutosuggest.init(liveEditor.editor.editor);
    </script>
</body>

</html>